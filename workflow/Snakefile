configfile: "config/config.yaml"

include: "rules/common.smk"
include: "rules/data/gwas.smk"
include: "rules/data/gwas_gokcen.smk"
include: "rules/data/splicing_assay.smk"
include: "rules/data/caqtl.smk"
include: "rules/data/dsqtl.smk"
include: "rules/data/sat_mut_mpra.smk"
include: "rules/data/siraj.smk"
include: "rules/features/cadd.smk"
include: "rules/features/conservation.smk"
include: "rules/features/dist.smk"
include: "rules/features/enformer.smk"
include: "rules/features/gpn.smk"
include: "rules/features/gpn_msa.smk"
include: "rules/features/grelu.smk"
include: "rules/features/maf.smk"
include: "rules/model.smk"


rule all:
    input:
        expand(
            "results/dataset/{dataset}/plot.pdf",
            #"results/dataset/{dataset}/plot_by_chrom.pdf",
            dataset=config["datasets"],
        )
        #expand(
        #    "results/interpretation/top_features/gwas_gokcen_experiment1_{trait}/{model}_L2.csv",
        #    trait=[
        #        "IBD",
        #        "Height",
        #        "CD",
        #        "BMD-HT",
        #        "PLT",
        #    ],
        #    model=[
        #        "Enformer",
        #        "Borzoi",
        #    ],
        #)


rule all_unsupervised:
    input:
        expand(
            "results/dataset/{dataset}/unsupervised_metrics/{features}.csv",
            dataset=config["datasets"],
            features=[
                "Enformer_L2",
                "Enformer_L2_L2",
                "Borzoi_L2",
                "Borzoi_L2_L2",
                "GPN-MSA_absLLR",
                "GPN-MSA_InnerProducts",
                "CADD",
                #"GPN_EmbedDists",
            ]
        )